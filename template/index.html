<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <title>Icons - Icons Factory</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        
        .icons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .icon-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .icon-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }
        
        .icon-image {
            max-width: 64px;
            max-height: 64px;
            width: auto;
            height: auto;
            margin: 0 auto 15px;
            display: block;
            object-fit: contain;
        }
        
        .icon-name {
            text-align: center;
            font-weight: 500;
            margin-bottom: 8px;
            color: #333;
            word-break: break-word;
        }
        
        .icon-size {
            text-align: center;
            font-size: 12px;
            color: #666;
            margin-bottom: 15px;
        }
        
        .button-group {
            display: flex;
            gap: 8px;
            justify-content: center;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .btn-copy {
            background-color: #4285f4;
            color: white;
        }
        
        .btn-copy:hover {
            background-color: #3367d6;
        }
        
        .btn-download {
            background-color: #34a853;
            color: white;
        }
        
        .btn-download:hover {
            background-color: #137333;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #333;
            color: white;
            padding: 12px 20px;
            border-radius: 4px;
            opacity: 0;
            transform: translateY(100%);
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        /* Ê§úÁ¥¢Ê©üËÉΩ„ÅÆ„Çπ„Çø„Ç§„É´ */
        .search-container {
            max-width: 500px;
            margin: 0 auto 30px;
            position: relative;
        }
        
        .search-box {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 25px;
            background: white;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            border-color: #4285f4;
            box-shadow: 0 2px 8px rgba(66, 133, 244, 0.2);
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            font-size: 16px;
            color: #666;
            pointer-events: none;
        }
        
        .search-clear {
            position: absolute;
            right: 15px;
            background: none;
            border: none;
            font-size: 18px;
            color: #999;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .search-clear.visible {
            opacity: 1;
        }
        
        .search-clear:hover {
            color: #666;
        }
        
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .no-results-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .search-stats {
            text-align: center;
            margin-bottom: 20px;
            color: #666;
            font-size: 14px;
        }
        
        /* Ê§úÁ¥¢„Éè„Ç§„É©„Ç§„Éà */
        .highlight {
            background: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .search-input {
                font-size: 16px; /* iOS„Åß„Ç∫„Éº„É†„ÇíÈò≤„Åê */
            }
        }
    </style>
</head>
<body>
    <h1 id="page-title">Icons</h1>
    
    <!-- Ê§úÁ¥¢Ê©üËÉΩ -->
    <div class="search-container">
        <div class="search-box">
            <input 
                type="text" 
                id="category-search" 
                class="search-input" 
                placeholder="„Ç¢„Ç§„Ç≥„É≥„ÇíÊ§úÁ¥¢..."
                autocomplete="off"
            >
            <div class="search-icon">üîç</div>
            <button id="search-clear" class="search-clear">√ó</button>
        </div>
    </div>
    
    <div id="search-stats" class="search-stats" style="display: none;"></div>
    <div id="loading" class="loading">„Ç¢„Ç§„Ç≥„É≥„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>
    <div id="icons-container" class="icons-grid"></div>
    
    <div id="toast" class="toast"></div>

    <script>
        // „Éï„Ç©„É´„ÉÄÂêç„ÇíËá™ÂãïÂèñÂæó
        const folderName = window.location.pathname.split('/').filter(p => p).pop() || '';
        
        // „Éö„Éº„Ç∏„Çø„Ç§„Éà„É´„ÇíËá™ÂãïË®≠ÂÆö
        if (folderName) {
            const displayName = folderName.toUpperCase();
            document.getElementById('page-title').textContent = `${displayName} Icons`;
            document.title = `${displayName} Icons - Icons Factory`;
        }

        // „Ç¢„Ç§„Ç≥„É≥„Éï„Ç°„Ç§„É´„ÅÆË°®Á§∫Áî®URLÔºàÁõ∏ÂØæ„Éë„ÇπÔºâ
        const getIconDisplayUrl = (filename) => {
            return `./${filename}`;
        };

        // URL„Ç≥„Éî„ÉºÁî®„ÅÆÁµ∂ÂØæURL
        const getIconCopyUrl = (filename) => {
            const baseUrl = window.location.origin + window.location.pathname.replace(/\/$/, '');
            return `${baseUrl}/${filename}`;
        };

        // „Ç¢„Ç§„Ç≥„É≥„É™„Çπ„ÉàJSON„ÅÆURL
        const getIconListUrl = () => {
            return './icons.json';
        };

        // „Éà„Éº„Çπ„ÉàË°®Á§∫
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast show';
            if (type === 'error') {
                toast.style.backgroundColor = '#f44336';
            } else {
                toast.style.backgroundColor = '#333';
            }
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // URL„Ç≥„Éî„ÉºÊ©üËÉΩ
        async function copyUrl(filename) {
            const url = getIconCopyUrl(filename);
            try {
                await navigator.clipboard.writeText(url);
                showToast('URL„Çí„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü');
            } catch (err) {
                showToast('„Ç≥„Éî„Éº„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
            }
        }

        // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊ©üËÉΩ
        async function downloadIcon(filename) {
            try {
                showToast('„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊ∫ñÂÇô‰∏≠...');
                
                // Áõ∏ÂØæ„Éë„Çπ„Åß„Éï„Ç°„Ç§„É´„Å´„Ç¢„ÇØ„Çª„ÇπÔºàÂêå‰∏Ä„Ç™„É™„Ç∏„É≥„Å™„ÅÆ„ÅßCORSÂà∂Èôê„Å™„ÅóÔºâ
                const response = await fetch(`./${filename}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                // „Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàURL„Çí„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
                window.URL.revokeObjectURL(url);
                
                showToast('„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„ÇíÈñãÂßã„Åó„Åæ„Åó„Åü');
            } catch (error) {
                console.error('„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Ç®„É©„Éº:', error);
                showToast('„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'error');
            }
        }


        // Ê§úÁ¥¢Ê©üËÉΩÂ§âÊï∞
        let allIcons = [];
        let searchTimeout;
        
        // Ê§úÁ¥¢ÂÆüË°å
        function performSearch(query) {
            const normalizedQuery = query.toLowerCase().trim();
            
            if (!normalizedQuery) {
                displayIcons(allIcons);
                updateSearchStats(allIcons.length, allIcons.length);
                return;
            }
            
            const filteredIcons = allIcons.filter(filename => {
                const iconName = filename.replace('.png', '').toLowerCase();
                return iconName.includes(normalizedQuery);
            });
            
            displayIcons(filteredIcons, normalizedQuery);
            updateSearchStats(filteredIcons.length, allIcons.length);
        }
        
        // „Ç¢„Ç§„Ç≥„É≥Ë°®Á§∫
        function displayIcons(icons, searchQuery = '') {
            const iconsContainer = document.getElementById('icons-container');
            
            if (icons.length === 0 && searchQuery) {
                iconsContainer.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon">üîç</div>
                        <div>„Äå${escapeHtml(searchQuery)}„Äç„Å´„Éû„ÉÉ„ÉÅ„Åô„Çã„Ç¢„Ç§„Ç≥„É≥„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</div>
                    </div>
                `;
            } else if (icons.length === 0) {
                iconsContainer.innerHTML = '<p style="text-align: center; color: #666;">„Ç¢„Ç§„Ç≥„É≥„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü</p>';
            } else {
                const iconsHtml = icons.map(filename => createIconCard(filename, searchQuery)).join('');
                iconsContainer.innerHTML = iconsHtml;
            }
        }
        
        // Ê§úÁ¥¢Áµ±Ë®àÊõ¥Êñ∞
        function updateSearchStats(filteredCount, totalCount) {
            const searchStats = document.getElementById('search-stats');
            const searchInput = document.getElementById('category-search');
            
            if (searchInput.value.trim()) {
                searchStats.textContent = `${totalCount}‰ª∂‰∏≠ ${filteredCount}‰ª∂„ÇíË°®Á§∫`;
                searchStats.style.display = 'block';
            } else {
                searchStats.style.display = 'none';
            }
        }
        
        // „Ç¢„Ç§„Ç≥„É≥„Ç´„Éº„Éâ„ÇíÂãïÁöÑ„Å´ÁîüÊàêÔºà„Éè„Ç§„É©„Ç§„Éà‰ªò„ÅçÔºâ
        function createIconCard(filename, searchQuery = '') {
            let iconName = filename.replace('.png', '').replace(/-/g, ' ');
            
            // Ê§úÁ¥¢„ÇØ„Ç®„É™„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„Éè„Ç§„É©„Ç§„Éà
            if (searchQuery) {
                iconName = highlightText(iconName, searchQuery);
            }
            
            const iconUrl = getIconDisplayUrl(filename);
            const iconId = `icon_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            
            return `
                <div class="icon-card">
                    <img id="${iconId}" src="${iconUrl}" alt="${filename.replace('.png', '')}" class="icon-image" 
                         onerror="this.style.display='none'" onload="updateIconSize('${iconId}', '${filename}')">
                    <div class="icon-name">${iconName}</div>
                    <div id="${iconId}_size" class="icon-size">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                    <div class="button-group">
                        <button class="btn btn-copy" onclick="copyUrl('${filename}')">
                            üìã URL „Ç≥„Éî„Éº
                        </button>
                        <button class="btn btn-download" onclick="downloadIcon('${filename}')">
                            üíæ „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                        </button>
                    </div>
                </div>
            `;
        }
        
        // „ÉÜ„Ç≠„Çπ„Éà„Éè„Ç§„É©„Ç§„Éà
        function highlightText(text, query) {
            if (!query.trim()) return escapeHtml(text);
            
            const escapedText = escapeHtml(text);
            const escapedQuery = escapeHtml(query);
            const regex = new RegExp(`(${escapedQuery})`, 'gi');
            
            return escapedText.replace(regex, '<span class="highlight">$1</span>');
        }
        
        // HTML„Ç®„Çπ„Ç±„Éº„Éó
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // „Ç¢„Ç§„Ç≥„É≥„Çµ„Ç§„Ç∫ÂèñÂæó„ÉªË°®Á§∫
        function updateIconSize(iconId, filename) {
            const img = document.getElementById(iconId);
            const sizeDiv = document.getElementById(`${iconId}_size`);
            
            if (img && sizeDiv) {
                if (img.naturalWidth && img.naturalHeight) {
                    sizeDiv.textContent = `${img.naturalWidth} √ó ${img.naturalHeight}px`;
                } else {
                    sizeDiv.textContent = '„Çµ„Ç§„Ç∫ÂèñÂæóÂ§±Êïó';
                }
            }
        }
        
        // „Ç¢„Ç§„Ç≥„É≥„É™„Çπ„Éà„ÇíË™≠„ÅøËæº„ÅøÔºàÊ§úÁ¥¢ÂØæÂøúÁâàÔºâ
        async function loadIconList() {
            const iconsContainer = document.getElementById('icons-container');
            const loading = document.getElementById('loading');
            
            try {
                // GitHub Actions„ÅßÁîüÊàê„Åï„Çå„Åü„Ç¢„Ç§„Ç≥„É≥„É™„Çπ„Éà„ÇíÂèñÂæó
                const response = await fetch(getIconListUrl());
                if (!response.ok) {
                    throw new Error('„Ç¢„Ç§„Ç≥„É≥„É™„Çπ„Éà„ÅÆÂèñÂæó„Å´Â§±Êïó');
                }
                
                const data = await response.json();
                allIcons = data.icons || [];
                
                if (allIcons.length > 0) {
                    displayIcons(allIcons);
                    updateSearchStats(allIcons.length, allIcons.length);
                    showToast(`${allIcons.length}ÂÄã„ÅÆ„Ç¢„Ç§„Ç≥„É≥„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü`);
                } else {
                    iconsContainer.innerHTML = '<p style="text-align: center; color: #666;">„Ç¢„Ç§„Ç≥„É≥„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü</p>';
                }
                
            } catch (error) {
                console.error('„Ç¢„Ç§„Ç≥„É≥„É™„Çπ„Éà„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó:', error);
                iconsContainer.innerHTML = '<p style="text-align: center; color: #ff4444;">„Ç¢„Ç§„Ç≥„É≥„É™„Çπ„Éà„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</p>';
                showToast('„Ç¢„Ç§„Ç≥„É≥„É™„Çπ„Éà„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
            } finally {
                // „É≠„Éº„Éá„Ç£„É≥„Ç∞ÈùûË°®Á§∫
                loading.style.display = 'none';
            }
        }
        
        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„ÅÆÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            loadIconList();
            
            const searchInput = document.getElementById('category-search');
            const clearButton = document.getElementById('search-clear');
            
            // „É™„Ç¢„É´„Çø„Ç§„É†Ê§úÁ¥¢
            searchInput.addEventListener('input', function(e) {
                const query = e.target.value;
                
                // „ÇØ„É™„Ç¢„Éú„Çø„É≥„ÅÆË°®Á§∫/ÈùûË°®Á§∫
                clearButton.classList.toggle('visible', query.length > 0);
                
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    performSearch(query);
                }, 300);
            });
            
            // „ÇØ„É™„Ç¢„Éú„Çø„É≥
            clearButton.addEventListener('click', function() {
                searchInput.value = '';
                clearButton.classList.remove('visible');
                performSearch('');
                searchInput.focus();
            });
            
            // ESC„Ç≠„Éº„ÅßÊ§úÁ¥¢„ÇØ„É™„Ç¢
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    searchInput.value = '';
                    clearButton.classList.remove('visible');
                    performSearch('');
                }
            });
        });
    </script>
</body>
</html>